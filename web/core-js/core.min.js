"use strict";class CustomerData{async init(){try{let r=await fetch(`${BASE_URL}customer/section/load`);if(!r.ok)throw Error("Network response was not ok");let a=await r.json();localStorage.setItem(`${STORAGE_KEY}`,JSON.stringify(a))}catch(i){console.error("Error while initializing the customer data:",i.message)}}loadFromLocalStorage(){let e=localStorage.getItem(`${STORAGE_KEY}`);return e?JSON.parse(e):null}get(e){let t=this.loadFromLocalStorage();return t&&t[e]?t[e]:null}}const customerData=new CustomerData(BASE_URL);async function getCustomerDataSections(e){let t=`${BASE_URL}customer/section/load/?sections=${e}`;try{let r=await fetch(t,{method:"GET",headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"}});if(!r.ok)throw Error(`Network response was not ok: ${r.statusText}`);return await r.json()}catch(a){console.error("Error fetching customer section:",a)}}function getCookieValue(e){let t=document.cookie.match(RegExp("(^|;\\s*)"+e+"=([^;]*)"));return t?decodeURIComponent(t[2].replace(/\+/g," ")):null}function displayMessages(e){let t=document.getElementById("message-manager-se");t&&(e.forEach(e=>{let r=document.createElement("div");r.className=`p-3 ${getMessageClass(e.type)} rounded-sm border font-montmedium flex justify-start items-center w-full mb-2`,r.innerHTML=`
      <div>${e.text}</div>
      <button type="button" class="ml-auto" title="Close" onclick="removeMessage(this)">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5">
          <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
        </svg>
      </button>
    `,t.appendChild(r)}),setTimeout(clearMessages,4e3))}function getMessageClass(e){switch(e){case"notice":return"bg-[#fdf0d5] text-[#c07600] border-[#c076006b]";case"error":return"bg-red-100 text-red-600 border-red-400";default:return"bg-green-100 text-green-600 border-green-400"}}function clearMessages(){let e=document.getElementById("message-manager-se");e&&(e.innerHTML="")}function removeMessage(e){let t=e.closest("div");t&&t.remove()}function getCookie(e){let t=getCookieValue(e);if(t){let r=JSON.parse(t);Array.isArray(r)&&r.length>0&&displayMessages(r),document.cookie=`${e}=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;`}}customerData.init();let scriptTagAdded=!1;class ReCaptcha{constructor(e,t){this.reCaptchaId=e,this.jsLayout=t,this.settings=t.components[e]?.settings,this.captchaInitialized=!1,this.tokenField=null,this.init()}async init(){await this.loadApi(),this.renderReCaptcha()}async loadApi(){if(void 0!==this.isApiRegistered){!0===this.isApiRegistered&&this.dispatchReCaptchaApiReadyEvent();return}this.isApiRegistered=!1,window.globalOnRecaptchaOnLoadCallback=()=>{this.isApiRegistered=!0,this.dispatchReCaptchaApiReadyEvent()},this.addReCaptchaScriptTag()}dispatchReCaptchaApiReadyEvent(){let e=new Event("recaptchaapiready");document.dispatchEvent(e)}addReCaptchaScriptTag(){if(!scriptTagAdded){let e=document.createElement("script");e.src="https://www.google.com/recaptcha/api.js?onload=globalOnRecaptchaOnLoadCallback&render=explicit",e.defer=!0,document.head.appendChild(e),scriptTagAdded=!0}}renderReCaptcha(){window.grecaptcha&&window.grecaptcha.render?this.initCaptcha():document.addEventListener("recaptchaapiready",()=>this.initCaptcha())}initCaptcha(){if(this.captchaInitialized||!this.settings)return;this.captchaInitialized=!0;let e=document.getElementById(`${this.reCaptchaId}-wrapper`);if(!e)return;e.querySelector(".g-recaptcha").id=this.reCaptchaId;let t=e.closest("form");if(!t)return;let r={callback:e=>{this.reCaptchaCallback(e),this.validateReCaptcha(!0,t)},"expired-callback":()=>{this.validateReCaptcha(!1,t)},...this.settings.rendering},a=grecaptcha.render(this.reCaptchaId,r);this.initParentForm(t,a)}initParentForm(e,t){this.isInvisibleReCaptcha()&&e&&(this.tokenField=document.createElement("input"),this.tokenField.type="text",this.tokenField.name="token",this.tokenField.style.display="none",e.append(this.tokenField),this.tokenField.value||grecaptcha.execute(t));let r=e.querySelector('button[type="submit"]');r&&(r.disabled=!1)}reCaptchaCallback(e){this.isInvisibleReCaptcha()&&(this.tokenField.value=e)}validateReCaptcha(e,t){if(!this.isInvisibleReCaptcha()){let r=t.querySelector("input[type=checkbox].required-captcha");r&&(r.checked=e)}}isInvisibleReCaptcha(){return this.settings?.invisible||!1}}function initReCaptcha(e,t){new ReCaptcha(e,t)}function getFormKeyCookie(){for(var e="form_key=",t=document.cookie.split(";"),r=0;r<t.length;r++){for(var a=t[r];" "==a.charAt(0);)a=a.substring(1,a.length);if(0==a.indexOf(e))return sanitizeInput(a.substring(e.length,a.length))}return null}function sanitizeInput(e){return e.replace(/[^\w-]/g,"")}function formInteractionHandler(){return{customerDetails:[],comparableProducts:[],addToCartLoader:!1,init(){this.$watch("customerDetails",e=>this.$dispatch("set-cart",e)),this.$watch("comparableProducts",e=>this.$dispatch("set-compareproducts",e)),this.$watch("addToCartLoader",e=>this.$dispatch("set-cartloader",e))},cartAddFormHandler(e,t){let r=document.getElementById(e);r.querySelectorAll('input[name="qty"]').forEach(e=>{"wishlist-qty"===e.dataset.input&&e.remove()}),document.querySelectorAll(".vira-form-validation").forEach(e=>e.remove());let a=!0,i="";if(r.querySelectorAll("input[required], select[required], textarea[required]").forEach(e=>{if("checkbox"===e.type){let t=e.id.split("_"),r=document.getElementById(t[0]+"-"+t[1]+"-list");if(r&&!r.querySelectorAll('input[type="checkbox"]:checked').length)return}if(!e.checkValidity()){i||(i=e);let s=e.parentNode.parentNode.querySelector(".vira-form-validation");if(s){if(Array.from(s.querySelectorAll(".error-message")).some(t=>t.textContent===e.validationMessage))return}else(s=document.createElement("div")).classList.add("vira-form-validation"),e.parentNode.parentNode.appendChild(s);let o=document.createElement("div");return o.classList.add("error-message"),o.textContent=e.validationMessage,s.appendChild(o),i.parentNode.parentNode.scrollIntoView({behavior:"smooth",block:"start"}),a=!1,!1}}),!a)return!1;let s=r.querySelector('input[name="product"]');this.addToCartLoader=s.value,r.addEventListener("submit",e=>e.preventDefault());let o=new FormData(r);o.append("form_key",getFormKeyCookie()),fetch(t,{method:"POST",body:o,credentials:"include"}).then(e=>{if(this.addToCartLoader=!1,e.ok){let t=window.location.pathname.split("/")[2];window.location.href!==e.url&&e.url!==BASE_URL&&e.url!==`${BASE_URL}customer/section/load`||"cart"===t?window.location.href=e.url:this.refreshCustomerData()}else this.refreshCustomerData(),console.error("Error:",e.status)}).catch(e=>console.error("Fetch error:",e))},wishlistFormHandler(e,t){let r=document.getElementById(e);r.querySelectorAll('input[name="qty"]').forEach(e=>{"wishlist-qty"===e.dataset.input&&e.remove()}),document.querySelectorAll(".vira-form-validation").forEach(e=>e.remove()),r.querySelector('input[name="product"]'),r.addEventListener("submit",e=>e.preventDefault());let a=new FormData(r);a.append("form_key",getFormKeyCookie()),fetch(t,{method:"POST",body:a,credentials:"include"}).then(e=>{e.ok&&(window.location.href=e.url)}).catch(e=>console.error("Fetch error:",e))},addToCompare(e){let t=getFormKeyCookie(),r=`${BASE_URL}catalog/product_compare/add/`;fetch(r,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},body:`form_key=${t}&product=${e}`,mode:"cors",credentials:"include"}).then(e=>{e.ok?this.refreshCustomerData():console.error("Error:",e.status)}).catch(e=>console.error("Fetch error:",e))},refreshCustomerData(){getCookie("mage-messages"),fetch(`${BASE_URL}customer/section/load`).then(e=>{if(!e.ok)throw Error("Network response was not ok");return e.json()}).then(e=>{this.customerDetails=e.cart,this.addToCartLoader=!1,this.comparableProducts=e["compare-products"]}).catch(e=>console.error("There was a problem with the fetch operation:",e))}}}function openPopup(e,t){var r=(window.innerWidth-800)/2,a=(window.innerHeight-600)/2,i=window.open(e,t,"width=800,height=600,left="+r+",top="+a+",resizable=yes,scrollbars=yes");i&&i.focus()}
